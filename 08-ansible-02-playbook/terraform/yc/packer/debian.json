{
  "builders": [
    {
      "type": "yandex",
      "token": "",
      "folder_id": "",
      "zone": "",

      "image_name": "debian-11-test-netology",
      "image_family": "debian-server-raw",
      "image_description": "my custom debian image",

      "source_image_family": "debian-11",
      "subnet_id": "",
      "use_ipv4_nat": true,
      "disk_type": "network-ssd",
      "ssh_username": "debian"
    }
  ],
  "provisioners": [
    {
      "type": "file",
      "source": "debian_key.txt",
      "destination": "/home/debian/"
    },
    {
      "type": "file",
      "source": "debian_pass.txt",
      "destination": "/home/debian/"
    },
    {
      "type": "file",
      "source": "create_debian.sh",
      "destination": "/home/debian/"
    },
    {
      "type": "shell",
      "inline": [
        "echo '-- Updating APT --'",
        "sudo apt-get update",
        "echo '-- Begin packets installation --'",
        "sudo apt-get install -y gcc pip",
        "echo '-- Create my custom user --'",
        "sudo adduser netology --disabled-password --quiet --home '/home/netology' --gecos 'Netology'",
        "echo '-- Granting sudo group to netology --'",
        "sudo usermod -aG sudo netology",
        "echo '-- Create ssh directory for netology --'",
        "sudo mkdir /home/netology/.ssh && sudo chown -R netology:netology /home/netology/",
        "echo '-- Generate password and adding authorized_keys --'",
        "sudo ./create_debian.sh",
        "echo '-- All finished --'"
      ]
    }
  ]
}